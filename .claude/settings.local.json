{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nchore(claude): autoApprove ÏÑ§Ï†ïÏóê git Î∞è ÌååÏùº Î™ÖÎ†πÏñ¥ Ï∂îÍ∞Ä\n\nGit ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏôÄ ÌååÏùº ÏûëÏóÖÏùÑ ÏúÑÌïú bash Î™ÖÎ†πÏñ¥Î•º ÏûêÎèô ÏäπÏù∏ Î™©Î°ùÏóê Ï∂îÍ∞Ä:\n- git checkout, git merge\n- ÌååÏùº ÏûëÏóÖ Î™ÖÎ†πÏñ¥\n- maskable ÏïÑÏù¥ÏΩò ÏÉùÏÑ± Ïä§ÌÅ¨Î¶ΩÌä∏\n\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git push:*)",
      "Bash(npx tsc:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat(security): Ï¢ÖÌï© Î≥¥Ïïà Í∞ïÌôî Íµ¨ÌòÑ\n\nXSS, SQL Injection, Clickjacking Îì± Ï£ºÏöî Ïõπ Î≥¥Ïïà Ï∑®ÏïΩÏ†êÏóê ÎåÄÌïú\nÎã§Ï∏µ Î∞©Ïñ¥ Ï≤¥Í≥ÑÎ•º Íµ¨Ï∂ïÌñàÏäµÎãàÎã§.\n\n**Ï£ºÏöî Î≥ÄÍ≤ΩÏÇ¨Ìï≠:**\n\n1. **Î≥¥Ïïà Ìó§Îçî Ï∂îÍ∞Ä (next.config.ts)**\n   - Content-Security-Policy (CSP): XSS Í≥µÍ≤© ÏòÅÌñ• ÏµúÏÜåÌôî\n   - X-Frame-Options: Clickjacking Í≥µÍ≤© Î∞©Ïñ¥\n   - X-Content-Type-Options: MIME ÌÉÄÏûÖ Ïä§ÎãàÌïë Ï∞®Îã®\n   - Referrer-Policy: ÌîÑÎùºÏù¥Î≤ÑÏãú Î≥¥Ìò∏\n   - Permissions-Policy: Î∂àÌïÑÏöîÌïú Î∏åÎùºÏö∞Ï†Ä Í∏∞Îä• ÎπÑÌôúÏÑ±Ìôî\n\n2. **Input Sanitization Ïú†Ìã∏Î¶¨Ìã∞ (src/lib/security/input-sanitizer.ts)**\n   - HTML ÌÉúÍ∑∏ Ï†úÍ±∞ (XSS Î∞©Ïñ¥)\n   - SQL Injection ÏúÑÌóò Î¨∏Ïûê Ï†úÍ±∞\n   - Ïù¥Î©îÏùº/URL/Ï†ÑÌôîÎ≤àÌò∏ Í≤ÄÏ¶ù Î∞è Ï†ïÍ∑úÌôî\n   - ÌÖçÏä§Ìä∏ Í∏∏Ïù¥ Ï†úÌïú (DDoS Î∞©Ïñ¥)\n   - Zod transformÍ≥º ÌÜµÌï© Í∞ÄÎä•Ìïú sanitizer Ï≤¥Ïù∏\n\n3. **API RouteÏóê Sanitization Ï†ÅÏö©**\n   - members APIÏóê ÏûÖÎ†• Í≤ÄÏ¶ù Î∞è Ï†ïÏ†ú Ï∂îÍ∞Ä\n   - Zod Ïä§ÌÇ§ÎßàÏóê transformÏùÑ ÌÜµÌïú ÏûêÎèô sanitization\n   - Î™®Îì† ÏÇ¨Ïö©Ïûê ÏûÖÎ†•Ïù¥ Ï†ÄÏû• Ï†Ñ Ï†ïÏ†úÎê®\n\n4. **Î≥¥Ïïà Î¨∏ÏÑú ÏûëÏÑ± (docs/SECURITY.md)**\n   - SQL Injection Î∞©Ïñ¥ Í∞ÄÏù¥Îìú\n   - XSS Î∞©Ïñ¥ Ï†ÑÎûµ\n   - CSRF Î∞©Ïñ¥ ÏÑ§Î™Ö\n   - Rate Limiting Íµ¨ÌòÑ Í∞ÄÏù¥Îìú (Upstash Redis)\n   - ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏\n\n**Î≥¥Ïïà Í∞úÏÑ† Ìö®Í≥º:**\n- ‚úÖ XSS Í≥µÍ≤©: Îã§Ï∏µ Î∞©Ïñ¥ (React auto-escape + sanitization + CSP)\n- ‚úÖ SQL Injection: Supabase + Ï∂îÍ∞Ä sanitization\n- ‚úÖ Clickjacking: X-Frame-OptionsÎ°ú Ï∞®Îã®\n- ‚úÖ MIME Ïä§ÎãàÌïë: X-Content-Type-OptionsÎ°ú Î∞©Ïñ¥\n- ‚ö†Ô∏è Rate Limiting: Î¨∏ÏÑúÌôî ÏôÑÎ£å, ÌîÑÎ°úÎçïÏÖòÏóêÏÑú Upstash Í∂åÏû•\n\n**Îã§Ïùå Îã®Í≥Ñ:**\nÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ Ïãú Upstash RedisÎ•º ÏÇ¨Ïö©Ìïú Rate Limiting Íµ¨ÌòÑ Í∂åÏû•\n(docs/SECURITY.md Ï∞∏Í≥†)\n\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(npx @sentry/wizard@latest:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat(monitoring): Sentry ÏóêÎü¨ Ìä∏ÎûòÌÇπ ÏãúÏä§ÌÖú Íµ¨Ï∂ï\n\nÌîÑÎ°úÎçïÏÖò ÌôòÍ≤ΩÏóêÏÑú ÏóêÎü¨Î•º ÏûêÎèôÏúºÎ°ú SentryÏóê Î¶¨Ìè¨Ìä∏ÌïòÏó¨ Îπ†Î•∏ Ïù¥Ïäà ÌååÏïÖ Î∞è\nÌï¥Í≤∞Ïù¥ Í∞ÄÎä•ÌïòÎèÑÎ°ù Sentry ÌÜµÌï©ÏùÑ ÏôÑÎ£åÌñàÏäµÎãàÎã§.\n\n**Ï£ºÏöî Íµ¨ÌòÑÏÇ¨Ìï≠:**\n\n1. **Sentry Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò** (@sentry/nextjs)\n   - Next.js 16 Í≥µÏãù ÏßÄÏõê\n   - ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏, ÏÑúÎ≤Ñ, Edge Runtime Î™®Îëê ÏßÄÏõê\n\n2. **Sentry ÏÑ§Ï†ï ÌååÏùº ÏÉùÏÑ±**\n   - `sentry.client.config.ts` - Î∏åÎùºÏö∞Ï†Ä ÏóêÎü¨ Ìä∏ÎûòÌÇπ\n   - `sentry.server.config.ts` - ÏÑúÎ≤Ñ/API ÏóêÎü¨ Ìä∏ÎûòÌÇπ\n   - `sentry.edge.config.ts` - Edge Runtime ÏóêÎü¨ Ìä∏ÎûòÌÇπ\n   - `instrumentation.ts` - Next.js 16 Í≥ÑÏ∏° ÏÑ§Ï†ï\n\n3. **Next.js ÌÜµÌï©** (`next.config.ts`)\n   - withSentryConfigÎ°ú Next.js ÏÑ§Ï†ï ÎûòÌïë\n   - ÏÜåÏä§Îßµ ÏóÖÎ°úÎìú ÏÑ§Ï†ï (ÌîÑÎ°úÎçïÏÖò ÎîîÎ≤ÑÍπÖÏö©)\n   - CSP Ìó§ÎçîÏóê Sentry ÎèÑÎ©îÏù∏ Ï∂îÍ∞Ä\n\n4. **ÎØºÍ∞êÌïú Ï†ïÎ≥¥ ÌïÑÌÑ∞ÎßÅ**\n   - Authorization Ìó§Îçî, Ïø†ÌÇ§ ÏûêÎèô Ï†úÍ±∞\n   - ÌôòÍ≤Ω Î≥ÄÏàò ÎßàÏä§ÌÇπ\n   - ÎπÑÎ∞ÄÎ≤àÌò∏, ÌÜ†ÌÅ∞ Îì± ÎØºÍ∞ê ÌïÑÎìú Ï†úÍ±∞\n   - Í∞úÎ∞ú ÌôòÍ≤ΩÏóêÏÑúÎäî ÏΩòÏÜîÏóêÎßå Ï∂úÎ†• (Ï†ÑÏÜ° Ïïà Ìï®)\n\n5. **ÏÑ±Îä• Î™®ÎãàÌÑ∞ÎßÅ ÏòµÏÖò**\n   - Ìä∏Î†àÏù¥Ïä§ ÏÉòÌîåÎßÅ (ÌîÑÎ°úÎçïÏÖò 10-20%)\n   - ÏÑ∏ÏÖò Ïû¨ÏÉù (ÏóêÎü¨ Î∞úÏÉù Ïãú 100%, ÏùºÎ∞ò 10%)\n   - HTTP ÏöîÏ≤≠ Ï∂îÏ†Å\n   - Î∏åÎùºÏö∞Ï†Ä ÏÑ±Îä• Ï∂îÏ†Å\n\n6. **ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï**\n   - `.env.example` ÏóÖÎç∞Ïù¥Ìä∏\n   - `env-validation.ts`Ïóê Sentry ÌôòÍ≤Ω Î≥ÄÏàò Í≤ÄÏ¶ù Ï∂îÍ∞Ä\n   - `.gitignore`Ïóê .env.example Ï†úÏô∏ Í∑úÏπô Ï∂îÍ∞Ä\n\n**ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ Ïãú ÌïÑÏöîÌïú ÏûëÏóÖ:**\n\n1. Sentry Í≥ÑÏ†ï ÏÉùÏÑ± (https://sentry.io/signup/)\n2. ÏÉà ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ± (Platform: Next.js ÏÑ†ÌÉù)\n3. DSN Î≥µÏÇ¨ ‚Üí `.env.local` ÎòêÎäî Vercel ÌôòÍ≤Ω Î≥ÄÏàòÏóê ÏÑ§Ï†ï:\n   ```\n   NEXT_PUBLIC_SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx\n   ```\n4. (ÏÑ†ÌÉù) ÏÜåÏä§Îßµ ÏóÖÎ°úÎìúÏö© Auth Token ÏÉùÏÑ± Î∞è ÏÑ§Ï†ï:\n   ```\n   SENTRY_ORG=your-org\n   SENTRY_PROJECT=seraphimon\n   SENTRY_AUTH_TOKEN=sntrys_xxx\n   ```\n\n**Ï£ºÏöî Í∏∞Îä•:**\n‚úÖ ÏûêÎèô ÏóêÎü¨ Ï∫°Ï≤ò (ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏/ÏÑúÎ≤Ñ/Edge Î™®Îëê)\n‚úÖ ÏÑ±Îä• Î™®ÎãàÌÑ∞ÎßÅ (API ÏùëÎãµ ÏãúÍ∞Ñ, ÌéòÏù¥ÏßÄ Î°úÎî© ÏÜçÎèÑ)\n‚úÖ ÏÜåÏä§Îßµ ÏßÄÏõê (ÌîÑÎ°úÎçïÏÖò ÏΩîÎìú ÎîîÎ≤ÑÍπÖ)\n‚úÖ ÏÇ¨Ïö©Ïûê Ïª®ÌÖçÏä§Ìä∏ (ÏóêÎü¨ Î∞úÏÉù Ïãú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Ï≤®Î∂Ä)\n‚úÖ Release Ï∂îÏ†Å (Git Ïª§Î∞ã Í∏∞Î∞ò Î≤ÑÏ†Ñ Í¥ÄÎ¶¨)\n\n**ÏùòÏ°¥ÏÑ±:**\n- @sentry/nextjs (v9 Ïù¥ÏÉÅ)\n\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "WebSearch",
      "WebFetch(domain:docs.sentry.io)",
      "Bash(claude mcp add:*)",
      "Bash(git commit:*)",
      "Bash(npm ls:*)",
      "Bash(npm outdated)",
      "Bash(npx supabase:*)",
      "Bash(curl:*)",
      "Bash(npm i:*)",
      "Bash(claude --version:*)",
      "Bash(npm view:*)",
      "Bash(npm update:*)",
      "Bash(npm uninstall:*)",
      "Bash(xargs ls:*)",
      "Bash(xargs:*)",
      "Bash(git diff:*)",
      "Bash(git log:*)",
      "Bash(npm test:*)",
      "Bash(npm run build:*)",
      "Bash(npm audit:*)",
      "Bash(node scripts/create-transparent-icons.js:*)",
      "Bash(node scripts/create-splash-icons.js:*)",
      "Bash(npx claude-code-templates@latest --hook=development-tools/nextjs-code-quality-enforcer --yes)",
      "Bash(npx claude-code-templates@latest --hook=pre-tool/update-search-year --yes)",
      "Bash(npx claude-code-templates@latest --hook=automation/dependency-checker --yes)",
      "Bash(npx claude-code-templates@latest --hook=automation/deployment-health-monitor --yes)",
      "Bash(VERCEL_TOKEN=\"vcp_7RO4wgAbWpnPvVTKbNU5FVmGa5YwZJWGsxwnjrgCGwyTgto0H32ljyan\" curl -s -H \"Authorization: Bearer vcp_7RO4wgAbWpnPvVTKbNU5FVmGa5YwZJWGsxwnjrgCGwyTgto0H32ljyan\" \"https://api.vercel.com/v2/user\")",
      "Bash(npx claude-code-templates@latest --hook=automation/simple-notifications --yes)",
      "Bash(npx claude-code-templates@latest --hook=git-workflow/auto-git-add --yes)",
      "Bash(npx claude-code-templates@latest --hook=git-workflow/smart-commit --yes)"
    ],
    "deny": [],
    "ask": []
  },
  "enableAllProjectMcpServers": true,
  "enabledMcpjsonServers": [
    "context7",
    "supabase"
  ],
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'input=$(cat); FILE_PATH=$(echo \"$input\" | jq -r \".tool_input.file_path // empty\"); SUCCESS=$(echo \"$input\" | jq -r \".tool_response.success // false\"); if [ \"$SUCCESS\" = \"true\" ] && [[ \"$FILE_PATH\" =~ \\.(js|jsx|ts|tsx)$ ]] && [[ ! \"$FILE_PATH\" =~ node_modules ]]; then echo \"üîç Next.js Code Quality Enforcer: Reviewing $FILE_PATH...\"; ISSUES=0; if [ -f \"$FILE_PATH\" ]; then if [[ \"$FILE_PATH\" =~ app/.* ]]; then echo \"üìÅ App Router file detected: $FILE_PATH\"; if [[ \"$FILE_PATH\" =~ page\\.(js|jsx|ts|tsx)$ ]] && ! grep -q \"export default function\" \"$FILE_PATH\" 2>/dev/null && ! grep -q \"export default async function\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ùå Page component must export default function\" >&2; ((ISSUES++)); fi; if [[ \"$FILE_PATH\" =~ layout\\.(js|jsx|ts|tsx)$ ]] && ! grep -q \"children\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ùå Layout component should accept children prop\" >&2; ((ISSUES++)); fi; if [[ \"$FILE_PATH\" =~ page\\.(js|jsx|ts|tsx)$ ]] && ! grep -q \"Metadata\" \"$FILE_PATH\" 2>/dev/null && ! grep -q \"metadata\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ö†Ô∏è Consider adding metadata export for SEO\"; fi; if grep -q \"use client\" \"$FILE_PATH\" 2>/dev/null; then echo \"üñ•Ô∏è Client Component detected\"; if ! grep -E \"(useState|useEffect|onClick|onChange|onSubmit)\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ö†Ô∏è Client component without interactivity - consider Server Component\"; fi; else echo \"üöÄ Server Component (default)\"; if grep -E \"(useState|useEffect|onClick|onChange|onSubmit)\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ùå Interactive features in Server Component - add \\\"use client\\\" directive\" >&2; ((ISSUES++)); fi; fi; fi; if [[ \"$FILE_PATH\" =~ \\.(jsx|tsx)$ ]]; then if ! grep -q \"import.*React\" \"$FILE_PATH\" 2>/dev/null && grep -q \"<\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ö†Ô∏è JSX without React import (Next.js 17+ handles this automatically)\"; fi; if ! grep -q \"FC\\|FunctionComponent\" \"$FILE_PATH\" 2>/dev/null && grep -q \"props\" \"$FILE_PATH\" 2>/dev/null && [[ \"$FILE_PATH\" =~ \\.tsx$ ]]; then echo \"üí° Consider using React.FC or explicit prop types for TypeScript\"; fi; fi; if [[ \"$FILE_PATH\" =~ \\.js$ ]] && [ -f \"tsconfig.json\" ]; then echo \"üìù JavaScript file in TypeScript project: $FILE_PATH\"; echo \"üí° Consider migrating to TypeScript for better type safety\"; fi; if grep -q \"next/image\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚úÖ Using next/image for optimized images\"; elif grep -q \"<img\" \"$FILE_PATH\" 2>/dev/null; then echo \"üñºÔ∏è Regular <img> tag detected\"; echo \"üí° Consider using next/image for better performance\"; fi; if grep -q \"next/link\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚úÖ Using next/link for navigation\"; elif grep -q \"<a href=\" \"$FILE_PATH\" 2>/dev/null && ! grep -q \"http\" \"$FILE_PATH\" 2>/dev/null; then echo \"üîó Regular <a> tag for internal links detected\"; echo \"üí° Use next/link for internal navigation\"; fi; if grep -q \"getServerSideProps\\|getStaticProps\" \"$FILE_PATH\" 2>/dev/null; then echo \"‚ö†Ô∏è Pages Router data fetching methods detected\"; echo \"üí° Consider migrating to App Router with Server Components\"; fi; if grep -q \"className=.*{\" \"$FILE_PATH\" 2>/dev/null; then echo \"üé® Dynamic className detected\"; if ! grep -q \"clsx\\|classnames\\|cn(\" \"$FILE_PATH\" 2>/dev/null; then echo \"üí° Consider using clsx or similar utility for className concatenation\"; fi; fi; if [ $ISSUES -eq 0 ]; then echo \"‚úÖ Code quality check passed for $FILE_PATH\"; else echo \"‚ùå Found $ISSUES code quality issues in $FILE_PATH\" >&2; exit 2; fi; else echo \"‚ùå File $FILE_PATH not found\"; fi; else echo \"‚ÑπÔ∏è Code quality check skipped (not a JavaScript/TypeScript file or failed operation)\"; fi'",
            "timeout": 20
          }
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "if [[ \"$CLAUDE_TOOL_FILE_PATH\" == *package.json || \"$CLAUDE_TOOL_FILE_PATH\" == *requirements.txt || \"$CLAUDE_TOOL_FILE_PATH\" == *Cargo.toml || \"$CLAUDE_TOOL_FILE_PATH\" == *pom.xml || \"$CLAUDE_TOOL_FILE_PATH\" == *Gemfile ]]; then echo \"Dependency file modified: $CLAUDE_TOOL_FILE_PATH\"; if [[ \"$CLAUDE_TOOL_FILE_PATH\" == *package.json ]] && command -v npm >/dev/null 2>&1; then npm audit 2>/dev/null || true; npx npm-check-updates 2>/dev/null || true; elif [[ \"$CLAUDE_TOOL_FILE_PATH\" == *requirements.txt ]] && command -v safety >/dev/null 2>&1; then safety check -r \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null || true; elif [[ \"$CLAUDE_TOOL_FILE_PATH\" == *Cargo.toml ]] && command -v cargo >/dev/null 2>&1; then cargo audit 2>/dev/null || true; fi; fi"
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'input=$(cat); COMMAND=$(echo \"$input\" | jq -r \".tool_input.command // empty\"); SUCCESS=$(echo \"$input\" | jq -r \".tool_response.success // false\"); if [[ \"$COMMAND\" =~ (vercel|deploy|build) ]] && [ -n \"$VERCEL_TOKEN\" ] && [ -n \"$VERCEL_PROJECT_ID\" ]; then echo \"üè• Deployment Health Monitor: Checking deployment status...\"; DEPLOY_DATA=$(curl -s -H \"Authorization: Bearer $VERCEL_TOKEN\" \"https://api.vercel.com/v6/deployments?projectId=$VERCEL_PROJECT_ID&limit=5\" 2>/dev/null); if [ -n \"$DEPLOY_DATA\" ] && [ \"$DEPLOY_DATA\" != \"null\" ]; then RECENT_DEPLOYMENTS=$(echo \"$DEPLOY_DATA\" | jq -r \".deployments[]\"); TOTAL_DEPLOYMENTS=$(echo \"$DEPLOY_DATA\" | jq \".deployments | length\"); SUCCESS_COUNT=0; ERROR_COUNT=0; BUILDING_COUNT=0; echo \"üìä Recent deployment analysis ($TOTAL_DEPLOYMENTS deployments):\"; echo \"$DEPLOY_DATA\" | jq -r \".deployments[] | \\\"State: \\(.state) | Created: \\(.created | todateiso8601) | URL: \\(.url // \\\"N/A\\\")\\\"\"; for state in $(echo \"$DEPLOY_DATA\" | jq -r \".deployments[].state\"); do case \"$state\" in READY) ((SUCCESS_COUNT++));; ERROR|CANCELED) ((ERROR_COUNT++));; BUILDING|QUEUED) ((BUILDING_COUNT++));; esac; done; SUCCESS_RATE=$(( SUCCESS_COUNT * 100 / TOTAL_DEPLOYMENTS )); echo \"\" ; echo \"üìà Deployment Health Summary:\"; echo \"‚úÖ Successful: $SUCCESS_COUNT/$TOTAL_DEPLOYMENTS ($SUCCESS_RATE%)\"; echo \"‚ùå Failed: $ERROR_COUNT/$TOTAL_DEPLOYMENTS\"; echo \"üîÑ In Progress: $BUILDING_COUNT/$TOTAL_DEPLOYMENTS\"; if [ $ERROR_COUNT -gt 0 ]; then echo \"\" >&2; echo \"üö® DEPLOYMENT HEALTH ALERT!\" >&2; echo \"Recent failures detected: $ERROR_COUNT failed deployments\" >&2; echo \"Success rate: $SUCCESS_RATE%\" >&2; echo \"\" >&2; echo \"üîç Failed deployments:\" >&2; echo \"$DEPLOY_DATA\" | jq -r \".deployments[] | select(.state == \\\"ERROR\\\" or .state == \\\"CANCELED\\\") | \\\"‚ùå \\(.created | todateiso8601): \\(.url // \\\"No URL\\\")\\\"\" >&2; echo \"\" >&2; echo \"üí° Troubleshooting steps:\" >&2; echo \"‚Ä¢ Check Vercel dashboard for detailed error logs\" >&2; echo \"‚Ä¢ Review recent code changes\" >&2; echo \"‚Ä¢ Verify environment variables are set\" >&2; echo \"‚Ä¢ Check for build script errors\" >&2; if [ $SUCCESS_RATE -lt 50 ]; then echo \"üö® CRITICAL: Success rate below 50%!\" >&2; exit 2; fi; elif [ $SUCCESS_RATE -lt 80 ]; then echo \"‚ö†Ô∏è Warning: Success rate below 80%\"; fi; if [ $BUILDING_COUNT -gt 2 ]; then echo \"‚è≥ Multiple builds in progress ($BUILDING_COUNT)\"; echo \"üí° This might indicate build queue issues\"; fi; LATEST_DEPLOY=$(echo \"$DEPLOY_DATA\" | jq -r \".deployments[0]\"); LATEST_STATE=$(echo \"$LATEST_DEPLOY\" | jq -r \".state\"); LATEST_URL=$(echo \"$LATEST_DEPLOY\" | jq -r \".url // empty\"); LATEST_CREATED=$(echo \"$LATEST_DEPLOY\" | jq -r \".created\"); if [ -n \"$LATEST_CREATED\" ] && [ \"$LATEST_CREATED\" != \"null\" ]; then MINUTES_AGO=$(( ($(date +%s) - $LATEST_CREATED/1000) / 60 )); echo \"üïí Latest deployment: $LATEST_STATE ($MINUTES_AGO minutes ago)\"; if [ -n \"$LATEST_URL\" ]; then echo \"üåê URL: https://$LATEST_URL\"; fi; fi; echo \"‚úÖ Deployment health check completed\"; else echo \"‚ùå Unable to fetch deployment data from Vercel API\"; fi; else echo \"‚ÑπÔ∏è Deployment health monitoring skipped (not a deployment command or missing tokens)\"; fi'",
            "timeout": 30
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "if command -v osascript >/dev/null 2>&1; then osascript -e 'display notification \"Tool: $CLAUDE_TOOL_NAME completed\" with title \"Claude Code\"'; elif command -v notify-send >/dev/null 2>&1; then notify-send 'Claude Code' \"Tool: $CLAUDE_TOOL_NAME completed\"; fi"
          }
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "if [[ -f package.json ]] && npm run test:quick --silent >/dev/null 2>&1; then echo '‚úÖ Tests passed'; else echo '‚ö†Ô∏è Tests may need attention'; fi"
          }
        ]
      },
      {
        "matcher": "Edit|MultiEdit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "if [[ -n \"$CLAUDE_TOOL_FILE_PATH\" ]] && git rev-parse --git-dir >/dev/null 2>&1; then git add \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null || true; fi"
          }
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "if git rev-parse --git-dir >/dev/null 2>&1 && [[ -n \"$CLAUDE_TOOL_FILE_PATH\" ]]; then git add \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null; CHANGED_LINES=$(git diff --cached --numstat \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null | awk '{print $1+$2}'); if [[ $CHANGED_LINES -gt 0 ]]; then FILENAME=$(basename \"$CLAUDE_TOOL_FILE_PATH\"); if [[ $CHANGED_LINES -lt 10 ]]; then SIZE=\"minor\"; elif [[ $CHANGED_LINES -lt 50 ]]; then SIZE=\"moderate\"; else SIZE=\"major\"; fi; MSG=\"Update $FILENAME: $SIZE changes ($CHANGED_LINES lines)\"; git commit -m \"$MSG\" \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null || true; fi; fi"
          }
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "if git rev-parse --git-dir >/dev/null 2>&1 && [[ -n \"$CLAUDE_TOOL_FILE_PATH\" ]]; then git add \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null; FILENAME=$(basename \"$CLAUDE_TOOL_FILE_PATH\"); git commit -m \"Add new file: $FILENAME\" \"$CLAUDE_TOOL_FILE_PATH\" 2>/dev/null || true; fi"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "WebSearch",
        "hooks": [
          {
            "type": "command",
            "command": "python3 -c \"import json, sys, re; from datetime import datetime; input_data = json.load(sys.stdin); tool_input = input_data.get('tool_input', {}); query = tool_input.get('query', ''); current_year = str(datetime.now().year); has_year = re.search(r'\\\\b20\\\\d{2}\\\\b', query); has_temporal = any(word in query.lower() for word in ['latest', 'recent', 'current', 'new', 'now', 'today']); should_add_year = not has_year and not has_temporal; modified_query = f'{query} {current_year}' if should_add_year else query; output = {'hookSpecificOutput': {'hookEventName': 'PreToolUse', 'modifiedToolInput': {'query': modified_query}}}; print(json.dumps(output)); sys.exit(0)\"",
            "timeout": 5
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'if [ -n \"$VERCEL_TOKEN\" ] && [ -n \"$VERCEL_PROJECT_ID\" ]; then echo \"üè• Deployment Health Monitor: Initial health check...\"; DEPLOY_DATA=$(curl -s -H \"Authorization: Bearer $VERCEL_TOKEN\" \"https://api.vercel.com/v6/deployments?projectId=$VERCEL_PROJECT_ID&limit=1\" 2>/dev/null); if [ -n \"$DEPLOY_DATA\" ] && [ \"$DEPLOY_DATA\" != \"null\" ]; then LATEST_STATE=$(echo \"$DEPLOY_DATA\" | jq -r \".deployments[0].state // empty\"); LATEST_URL=$(echo \"$DEPLOY_DATA\" | jq -r \".deployments[0].url // empty\"); LATEST_CREATED=$(echo \"$DEPLOY_DATA\" | jq -r \".deployments[0].created // empty\"); if [ -n \"$LATEST_CREATED\" ] && [ \"$LATEST_CREATED\" != \"null\" ]; then MINUTES_AGO=$(( ($(date +%s) - $LATEST_CREATED/1000) / 60 )); case \"$LATEST_STATE\" in READY) echo \"‚úÖ Latest deployment: READY ($MINUTES_AGO minutes ago)\"; if [ -n \"$LATEST_URL\" ]; then echo \"üåê Live at: https://$LATEST_URL\"; fi;; ERROR) echo \"‚ùå Latest deployment: FAILED ($MINUTES_AGO minutes ago)\" >&2; echo \"üîß Check Vercel dashboard for details\" >&2;; BUILDING) echo \"üîÑ Latest deployment: BUILDING ($MINUTES_AGO minutes ago)\"; echo \"‚è≥ Build in progress...\";; QUEUED) echo \"‚è≥ Latest deployment: QUEUED ($MINUTES_AGO minutes ago)\";; *) echo \"‚ùì Latest deployment: $LATEST_STATE ($MINUTES_AGO minutes ago)\";; esac; echo \"üìä Deployment monitoring active\"; else echo \"‚ÑπÔ∏è No recent deployments found\"; fi; else echo \"‚ö†Ô∏è Unable to connect to Vercel API\"; fi; else echo \"‚ÑπÔ∏è Deployment health monitoring disabled (VERCEL_TOKEN or VERCEL_PROJECT_ID not set)\"; fi'",
            "timeout": 15
          }
        ]
      }
    ]
  }
}
